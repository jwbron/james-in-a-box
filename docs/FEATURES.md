# james-in-a-box Feature List

> **Purpose:** This list enables automated codebase and document analyzers to systematically assess each feature for quality, security, and improvement opportunities.
>
> **Generated:** This document was auto-generated by the Feature Analyzer.
>
> **Total Features:** 51 top-level features (119 including sub-features)

## Table of Contents

- [Communication](#communication)
- [Context Management](#context-management)
- [GitHub Integration](#github-integration)
- [Self-Improvement System](#self-improvement-system)
- [Documentation System](#documentation-system)
- [Custom Commands](#custom-commands)
- [Container Infrastructure](#container-infrastructure)
- [Utilities](#utilities)
- [Security Features](#security-features)
- [Configuration](#configuration)

---

## Communication

### 1. Slack Notifier Service
**Location:**
- `host-services/slack/slack-notifier/slack-notifier.py`
- `host-services/slack/slack-notifier/slack-notifier.service`
- `host-services/slack/slack-notifier/setup.sh`
- `bin/setup-slack-notifier`

Host-side systemd service that monitors ~/.jib-sharing/notifications/ and sends Slack DMs when files are created. Supports thread replies via YAML frontmatter, message batching (15-second window), auto-chunking for long content, and automatic retry.

### 2. Slack Receiver Service
**Location:**
- `host-services/slack/slack-receiver/slack-receiver.py`
- `host-services/slack/slack-receiver/slack-receiver.service`
- `host-services/slack/slack-receiver/setup.sh`
- `bin/setup-slack-receiver`

Receives incoming Slack DMs via Socket Mode and triggers jib container processing via jib --exec. Supports thread context detection, conversation history, user authentication/allowlisting, and remote control commands.

**Components:**

- **Remote Control via Slack** (`host-services/slack/slack-receiver/host_command_handler.py`)
  - Enables jib management through Slack DM commands: /jib status/restart/rebuild/logs and /service list/status/restart/start/stop/logs.
- **Slack Thread Context Preservation** (`host-services/slack/slack-receiver/slack-receiver.py`)
  - Maintains full conversation history for Slack threads by fetching all messages and including them in task files with YAML frontmatter.
- **Slack User Authentication** (`host-services/slack/slack-receiver/slack-receiver.py`)
  - Validates incoming Slack messages against a configurable list of allowed users, blocking unauthorized requests.
- **Container Process Monitoring** (`host-services/slack/slack-receiver/slack-receiver.py`)
  - Monitors jib container processes in background threads, streams output to logs, and creates failure notifications on errors or timeouts.
- **Message Chunking** (`host-services/slack/slack-receiver/slack-receiver.py`)
  - Automatically splits long messages into multiple chunks within Slack limits, breaking on natural boundaries.

### 3. Slack Message Processor
**Location:** `jib-container/jib-tasks/slack/incoming-processor.py`

Container-side processor for incoming Slack messages that routes them to Claude Code for task execution. Handles thread context, YAML frontmatter parsing, automatic notifications for success/failure states, and Beads integration.

### 4. Container Notifications Library
**Location:** `shared/notifications.py`

Python library for sending Slack notifications from within the container. Supports simple notifications, context for threading, and specialized notifications for PRs and code pushes.

## Context Management

### 5. Context Sync Service
**Location:**
- `host-services/sync/context-sync/sync_all.py`
- `host-services/sync/context-sync/manage_scheduler.sh`
- `host-services/sync/context-sync/context-sync.service`
- `host-services/sync/context-sync/setup.sh`

Multi-connector tool that automatically syncs external knowledge sources (Confluence, JIRA) to ~/context-sync/ for AI agent access. Runs hourly via systemd timer, supports incremental sync, and provides search functionality.

**Components:**

- **Base Connector Framework** (`host-services/sync/context-sync/connectors/base.py`)
  - Abstract base class defining standard interface for all sync connectors with config validation, sync operations, and cleanup.
- **Systemd Timer Scheduler** (`host-services/sync/context-sync/systemd/context-sync.service`)
  - Automated scheduling using systemd user timers for reliable hourly documentation syncing with configurable frequency.

### 6. Confluence Connector
**Location:**
- `host-services/sync/context-sync/connectors/confluence/connector.py`
- `host-services/sync/context-sync/connectors/confluence/sync.py`
- `host-services/sync/context-sync/connectors/confluence/config.py`

Syncs Confluence documentation including ADRs, runbooks, and team docs to local markdown files. Preserves page hierarchy, includes comments, creates hierarchical navigation indexes, and supports incremental sync.

**Components:**

- **Confluence Page Comments Sync** (`host-services/sync/context-sync/connectors/confluence/sync.py`)
  - Fetches and includes both footer and inline comments from Confluence pages, tracking changes separately for efficient updates.
- **Hierarchical Directory Index Generation** (`host-services/sync/context-sync/connectors/confluence/sync.py`)
  - Generates README.md navigation indexes for synced directories with main space index and subdirectory indexes.
- **Incremental Sync State Management** (`host-services/sync/context-sync/connectors/confluence/sync.py`)
  - Persists sync state using pickle to enable efficient incremental synchronization with content hash tracking.
- **Single Page Sync** (`host-services/sync/context-sync/connectors/confluence/sync.py`)
  - Allows syncing individual Confluence pages by ID or URL without syncing entire spaces.
- **Confluence Space Discovery** (`host-services/sync/context-sync/utils/list_spaces.py`)
  - Utilities to list available Confluence spaces and retrieve space IDs for configuration.
- **HTML to Markdown Converter** (`host-services/sync/context-sync/connectors/confluence/sync.py`)
  - Converts Confluence HTML content to Markdown format using html2text with Confluence-specific configuration.

### 7. JIRA Connector
**Location:**
- `host-services/sync/context-sync/connectors/jira/connector.py`
- `host-services/sync/context-sync/connectors/jira/sync.py`
- `host-services/sync/context-sync/connectors/jira/config.py`

Syncs JIRA tickets to local markdown files based on configurable JQL queries. Includes ticket comments, attachment metadata, work logs, and converts Atlassian Document Format to clean markdown with incremental sync support.

**Components:**

- **Atlassian Document Format Converter** (`host-services/sync/context-sync/connectors/jira/sync.py`)
  - Converts JIRA's ADF to clean markdown, handling paragraphs, headings, lists, code blocks, and inline formatting.
- **JIRA Incremental Sync** (`host-services/sync/context-sync/connectors/jira/sync.py`)
  - Intelligent change detection that tracks ticket hashes based on update timestamps and comment counts.

### 8. Beads Task Tracking System
**Location:** `jib-container/.claude/rules/beads-usage.md`, `jib-container/.claude/rules/context-tracking.md`

Persistent task tracking system that enables memory across container restarts. Provides commands for creating, updating, and completing tasks with status values, labeling conventions, and workflow patterns for ephemeral containers.

### 9. JIRA Ticket Processor
**Location:** `jib-container/jib-tasks/jira/jira-processor.py`

Monitors and analyzes JIRA tickets assigned to the user, using Claude to parse requirements, extract action items, assess scope, and send proactive Slack notifications. Creates Beads tasks for new tickets.

### 10. Sprint Ticket Analyzer
**Location:** `jib-container/jib-tasks/jira/analyze-sprint.py`

Analyzes tickets in the active sprint to provide actionable recommendations including next steps and suggestions for backlog tickets to pull in. Generates grouped Slack notifications.

### 11. PR Context Manager
**Location:**
- `jib-container/jib-tasks/github/comment-responder.py`
- `jib-container/jib-tasks/github/pr-reviewer.py`
- `jib-container/jib-tasks/github/github-processor.py`

Manages persistent PR context in Beads task tracking system, enabling memory across container restarts. Each PR gets a unique task tracking its lifecycle including comments, CI failures, and review feedback.

### 12. Beads Task Memory Initialization
**Location:** `setup.sh`

Sets up the Beads persistent task tracking system in the shared directory for task creation, progress tracking, and cross-session context.

## GitHub Integration

### 13. GitHub Watcher Service
**Location:**
- `host-services/analysis/github-watcher/github-watcher.py`
- `host-services/analysis/github-watcher/setup.sh`
- `host-services/analysis/github-watcher/README.md`
- `host-services/analysis/github-watcher/github-watcher.service`
- `host-services/analysis/github-watcher/github-watcher.timer`

Host-side systemd timer service that monitors GitHub repositories every 5 minutes for PR events including check failures, new comments, merge conflicts, and review requests. Automatically triggers jib container analysis via jib --exec when events are detected.

**Components:**

- **PR Check Failure Detection** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Monitors open PRs for CI check failures (failed, cancelled, timed out) and triggers container analysis to fix failing tests or builds.
- **PR Comment Monitoring** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Tracks new comments on PRs from other users, supporting issue comments, review body comments, and line-level review comments.
- **Merge Conflict Detection** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Detects PRs with merge conflicts and triggers container to automatically resolve them, tracking processed conflicts by commit SHA.
- **PR Review Request Handling** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Identifies new PRs from other authors that need code review and triggers automated review assistance.
- **Failed Task Retry System** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Tracks jib tasks that fail for automatic retry on next watcher run, bypassing timestamp filters.
- **Parallel Task Execution** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Executes multiple jib container tasks concurrently using ThreadPoolExecutor with configurable parallelism.
- **GitHub API Rate Limiting** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Implements rate limit handling with exponential backoff and automatic retries for GitHub CLI commands.
- **Persistent State Tracking** (`host-services/analysis/github-watcher/github-watcher.py`)
  - Maintains JSON state file tracking last run timestamp, processed failures, comments, reviews, conflicts, and failed tasks.

### 14. GitHub CI/CD Failure Processor
**Location:** `jib-container/jib-tasks/github/github-processor.py`, `jib-container/jib-tasks/github/README.md`

Container-side processor that automatically analyzes CI/CD check failures on PRs. Detects test failures, linting errors, and build failures, creates Beads tasks, and can auto-fix certain issues. Triggered by GitHub Watcher.

**Components:**

- **Merge Conflict Resolution Handler** (`jib-container/jib-tasks/github/github-processor.py`)
  - Invokes Claude to checkout PR branch, merge base, identify conflicts, resolve intelligently, and push resolution.

### 15. PR Auto-Review System
**Location:** `jib-container/jib-tasks/github/pr-reviewer.py`, `jib-container/jib-tasks/github/README.md`

Automatically reviews new PRs from others, analyzing diffs for code quality, security concerns (eval/exec, SQL injection, XSS), performance issues, and best practices. Generates comprehensive file-by-file reviews.

### 16. PR Comment Auto-Responder
**Location:** `jib-container/jib-tasks/github/comment-responder.py`, `jib-container/jib-tasks/github/README.md`

Monitors comments on your own PRs and uses Claude to generate contextual responses. Handles questions, change requests, concerns, and positive feedback. Can make code changes for writable repos.

### 17. PR Analyzer Tool
**Location:**
- `host-services/analysis/analyze-pr/analyze-pr.py`
- `host-services/analysis/analyze-pr/README.md`
- `jib-container/jib-tasks/github/pr-analyzer.py`

Analyzes GitHub Pull Requests by fetching comprehensive context (metadata, diff, comments, reviews, CI status, failed check logs) and uses Claude to analyze issues and suggest solutions. Supports analysis-only, fix mode, interactive sessions, and context-only modes.

### 18. GitHub Command Handler
**Location:** `jib-container/jib-tasks/github/command-handler.py`, `jib-container/jib-tasks/github/README.md`

Processes user commands received via Slack for GitHub operations like 'review PR 123' or '/pr review 123 webapp'. Parses commands and delegates to appropriate handlers.

### 19. GitHub App Token Generator
**Location:** `jib-container/jib-tools/github-app-token.py`

Generates short-lived (1 hour) GitHub App installation access tokens from stored credentials. Used by jib launcher to authenticate MCP server and git operations without SSH keys.

### 20. MCP Token Watcher
**Location:** `jib-container/scripts/mcp-token-watcher.py`

Daemon that monitors the shared GitHub token file and automatically reconfigures the GitHub MCP server when the token changes. Ensures MCP server always uses valid tokens.

## Self-Improvement System

### 21. LLM Trace Collector
**Location:**
- `host-services/analysis/trace-collector/trace_collector.py`
- `host-services/analysis/trace-collector/hook_handler.py`
- `host-services/analysis/trace-collector/schemas.py`
- `host-services/analysis/trace-collector/__init__.py`
- `host-services/analysis/trace-collector/setup.sh`

Collects structured traces of LLM tool calls for inefficiency analysis. Records every tool invocation with parameters, results, timing, and context metrics to JSONL files via Claude Code hooks (PostToolUse, SessionStart, SessionEnd).

**Components:**

- **Claude Code Hook Handler** (`host-services/analysis/trace-collector/hook_handler.py`)
  - Integrates with Claude Code's hook system to automatically capture trace events with minimal overhead.
- **Trace Event Schema System** (`host-services/analysis/trace-collector/schemas.py`)
  - Defines comprehensive data structures for trace events including TraceEvent, SessionMetadata, and tool categorization.
- **Trace Reader and Query CLI** (`host-services/analysis/trace-collector/trace_reader.py`)
  - Utilities for reading, querying, and analyzing collected traces with filtering, export, and summary capabilities.

### 22. LLM Inefficiency Detector
**Location:**
- `host-services/analysis/inefficiency-detector/inefficiency_detector.py`
- `host-services/analysis/inefficiency-detector/inefficiency_schema.py`
- `host-services/analysis/inefficiency-detector/base_detector.py`
- `host-services/analysis/inefficiency-detector/setup.sh`

Analyzes LLM trace sessions to detect processing inefficiencies such as tool discovery failures, retry storms, and resource waste. Generates session and aggregate reports with actionable recommendations.

**Components:**

- **Tool Discovery Detector** (`host-services/analysis/inefficiency-detector/detectors/tool_discovery_detector.py`)
  - Detects inefficiencies in finding and using tools including documentation misses, search failures, and API confusion.
- **Tool Execution Detector** (`host-services/analysis/inefficiency-detector/detectors/tool_execution_detector.py`)
  - Detects technical failures in tool invocation including retry storms and parameter validation errors.
- **Resource Efficiency Detector** (`host-services/analysis/inefficiency-detector/detectors/resource_efficiency_detector.py`)
  - Detects token and computational waste including redundant file reads and excessive context loading.
- **Improvement Proposer** (`host-services/analysis/inefficiency-detector/improvement_proposer.py`)
  - Generates structured improvement proposals from detected inefficiencies using predefined templates for human review.
- **Impact Tracker** (`host-services/analysis/inefficiency-detector/impact_tracker.py`)
  - Tracks effectiveness of implemented improvements by measuring actual vs expected token savings.
- **Weekly Report Generator** (`host-services/analysis/inefficiency-detector/weekly_report_generator.py`)
  - Automates weekly inefficiency analysis with PR creation and Slack notifications for human-in-the-loop approval.

### 23. Beads Integration Analyzer
**Location:**
- `host-services/analysis/beads-analyzer/beads-analyzer.py`
- `host-services/analysis/beads-analyzer/README.md`
- `host-services/analysis/beads-analyzer/setup.sh`
- `host-services/analysis/beads-analyzer/beads-analyzer.service`
- `host-services/analysis/beads-analyzer/beads-analyzer.timer`
- *...and 1 more*

Analyzes health and effectiveness of the Beads task tracking system across the jib ecosystem. Evaluates task lifecycle, context continuity, task quality, and generates weekly health reports (0-100 score) submitted as PRs.

**Components:**

- **Beads Metrics Collection** (`jib-container/jib-tasks/analysis/beads-analyzer-processor.py`)
  - Aggregates comprehensive metrics about Beads usage including task counts, notes coverage, label usage, and lifecycle metrics.
- **Beads Issue Detection** (`jib-container/jib-tasks/analysis/beads-analyzer-processor.py`)
  - Identifies problems like task abandonment, missing notes/labels, unsearchable titles, and orphan tasks categorized by severity.
- **AI-Powered Beads Analysis** (`jib-container/jib-tasks/analysis/beads-analyzer-processor.py`)
  - Uses Claude for intelligent analysis generating executive summaries, detecting anti-patterns, and scoring task quality.
- **Beads Health Report Generator** (`jib-container/jib-tasks/analysis/beads-analyzer-processor.py`)
  - Generates comprehensive markdown reports with health scores, metrics tables, and trend comparison.

### 24. Conversation Analyzer Service
**Location:**
- `host-services/analysis/conversation-analyzer/conversation-analyzer.service`
- `host-services/analysis/conversation-analyzer/conversation-analyzer.timer`
- `bin/setup-conversation-analyzer`

Weekly analysis service that analyzes Slack/GitHub conversation patterns to identify communication quality issues and improvement opportunities.

## Documentation System

### 25. Feature Analyzer Service
**Location:**
- `host-services/analysis/feature-analyzer/feature-analyzer.py`
- `host-services/analysis/feature-analyzer/adr_watcher.py`
- `host-services/analysis/feature-analyzer/doc_generator.py`

Automated feature detection and documentation sync workflow implementing ADR detection, multi-doc updates with LLM generation, PR creation, validation/rollback tooling, and full repository analysis for comprehensive feature lists.

### 26. ADR Researcher Service
**Location:**
- `host-services/analysis/adr-researcher/adr-researcher.py`
- `host-services/analysis/adr-researcher/README.md`
- `host-services/analysis/adr-researcher/setup.sh`
- `host-services/analysis/adr-researcher/adr-researcher.service`
- `host-services/analysis/adr-researcher/adr-researcher.timer`
- *...and 1 more*

Research-driven ADR workflow tool that researches open ADR PRs, updates merged ADRs with research findings, generates new ADRs grounded in industry research, and validates ADR claims. Runs weekly on Mondays.

**Components:**

- **Research Open ADR PRs** (`host-services/analysis/adr-researcher/adr-researcher.py`)
  - Identifies open PRs modifying ADR files and posts research findings as PR comments for reviewers.
- **ADR Generation from Research** (`host-services/analysis/adr-researcher/adr-researcher.py`)
  - Generates complete new ADRs grounded in web search research and submits as PRs.
- **ADR Review and Validation** (`host-services/analysis/adr-researcher/adr-researcher.py`)
  - Validates existing ADR claims against current industry research.
- **Topic Research Mode** (`host-services/analysis/adr-researcher/adr-researcher.py`)
  - Enables standalone research on any topic without creating ADRs.
- **Structured Research Result Parser** (`host-services/analysis/adr-researcher/adr-researcher.py`)
  - Parses Claude's markdown research output into strongly-typed Python dataclasses.

### 27. ADR Processor
**Location:** `jib-container/jib-tasks/adr/adr-processor.py`

Container-side dispatcher for ADR research tasks. Receives context from host-side adr-researcher via jib --exec and dispatches to specialized handlers for researching, generating, and reviewing ADRs.

### 28. Documentation Generator Pipeline
**Location:**
- `host-services/analysis/doc-generator/doc-generator.py`
- `host-services/analysis/doc-generator/setup.sh`
- `host-services/analysis/doc-generator/doc-generator.service`
- `host-services/analysis/doc-generator/doc-generator.timer`
- `bin/generate-docs`
- *...and 1 more*

A 4-agent pipeline (Context, Draft, Review, Output) that automatically generates documentation from codebase analysis. Analyzes code patterns from indexes and generates status-quo or pattern documentation.

**Components:**

- **Documentation PR Creation** (`host-services/analysis/doc-generator/setup.sh`)
  - Automated GitHub PR creation for generated documentation changes with descriptive messages.

### 29. Documentation Drift Detector
**Location:** `host-services/analysis/doc-generator/drift-detector.py`, `bin/check-doc-drift`

Compares documentation against current code to find discrepancies such as references to deleted files, stale line references, broken markdown links, and outdated paths. Provides suggestions for fixes.

### 30. Codebase Index Generator
**Location:**
- `host-services/analysis/index-generator/index-generator.py`
- `host-services/analysis/index-generator/setup.sh`
- `host-services/analysis/index-generator/index-generator.service`
- `host-services/analysis/index-generator/index-generator.timer`

Analyzes Python codebases to generate machine-readable JSON indexes (codebase.json, patterns.json, dependencies.json) for efficient LLM navigation without loading entire files into context.

### 31. Spec Enricher CLI
**Location:** `host-services/analysis/spec-enricher/spec-enricher.py`, `host-services/analysis/spec-enricher/setup.sh`

Command-line tool that enriches task specifications with relevant documentation links and code examples. Accepts specs from files or stdin and outputs in multiple formats (YAML, JSON, Markdown).

### 32. Documentation Link Fixer
**Location:** `scripts/fix-doc-links.py`

Automatically fixes broken links in documentation files by updating links to moved files, removing references to deleted files, and fixing relative path issues.

### 33. Confluence Documentation Watcher
**Location:** `jib-container/jib-tasks/confluence/confluence-processor.py`

Monitors Confluence documentation for changes focusing on ADRs and Runbooks. Uses Claude to analyze content and impact, creates tracking tasks in Beads, and sends notifications.

### 34. Documentation Index
**Location:** `docs/index.md`

Central navigation hub for all james-in-a-box documentation following the llms.txt standard for efficient LLM navigation.

## Custom Commands

### 35. Claude Custom Commands
**Location:** `jib-container/.claude/commands/README.md`

Slash command system for common agent operations including context management, PR creation, task status, and metrics display.

**Components:**

- **Load Context Command** (`jib-container/.claude/commands/load-context.md`)
  - Loads accumulated knowledge from context-sharing documents stored in ~/sharing/context/ for applying wisdom from previous sessions.
- **Save Context Command** (`jib-container/.claude/commands/save-context.md`)
  - Saves current session knowledge using ACE methodology (Generation -> Reflection -> Curation) to context documents.
- **Create PR Command** (`jib-container/.claude/commands/create-pr.md`)
  - Automated PR creation with smart description generation, JIRA issue extraction, and GitHub MCP integration.
- **Beads Status Command** (`jib-container/.claude/commands/beads-status.md`)
  - Displays current Beads task status with ready, in-progress, blocked, and completed tasks plus recommendations.
- **Beads Sync Command** (`jib-container/.claude/commands/beads-sync.md`)
  - Commits and syncs Beads task state to git repository ensuring persistence before container shutdown.
- **Update Confluence Doc Command** (`jib-container/.claude/commands/update-confluence-doc.md`)
  - Prepares updates for Confluence documents based on inline comments, formatted for copy-paste.
- **Show Metrics Command** (`jib-container/.claude/commands/show-metrics.md`)
  - Generates monitoring reports with API usage, task completion statistics, and optimization insights.

## Container Infrastructure

### 36. JIB Container Management System
**Location:**
- `bin/jib`
- `bin/view-logs`
- `host-services/shared/jib_exec.py`
- `host-services/shared/__init__.py`

The core 'jib' command provides the primary interface for starting, managing, and interacting with the sandboxed Docker development environment. Includes container lifecycle management, log viewing, and the jib --exec mechanism for host-to-container task execution.

**Components:**

- **JIB Execution Wrapper** (`host-services/shared/jib_exec.py`)
  - Standardized interface for host services to execute container-side processors via jib --exec, handling path translation, JSON parsing, and timeout management.
- **Container Log Viewer** (`bin/view-logs`)
  - Provides convenient access to Docker container logs for debugging and monitoring container activity.

### 37. Docker Development Environment Setup
**Location:** `bin/docker-setup.py`

Automates complete installation of Khan Academy development tools in the Docker container, including Python 3.11, Node.js 20.x, Go, Java 11, PostgreSQL, Redis, and various development utilities with cross-platform support for Ubuntu and Fedora.

### 38. Analysis Task Processor
**Location:** `jib-container/jib-tasks/analysis/analysis-processor.py`, `jib-container/jib-tasks/analysis/__init__.py`

Container-side dispatcher handling various analysis tasks via jib --exec. Provides task routing for LLM prompts, documentation generation, feature extraction, and PR creation.

**Components:**

- **LLM Prompt Execution Service** (`jib-container/jib-tasks/analysis/analysis-processor.py`)
  - Generic LLM prompt execution supporting both stdout and file-based JSON output modes.
- **ADR Documentation Generator** (`jib-container/jib-tasks/analysis/analysis-processor.py`)
  - Updates documentation files based on implemented ADRs while preserving structure and style.
- **Feature Extraction Service** (`jib-container/jib-tasks/analysis/analysis-processor.py`)
  - Analyzes source code to extract meaningful features for FEATURES.md documentation.
- **Container-Based PR Creation** (`jib-container/jib-tasks/analysis/analysis-processor.py`)
  - Creates GitHub PRs directly from container's isolated git worktree via gh CLI.

### 39. Session End Hook
**Location:** `jib-container/.claude/hooks/session-end.sh`, `jib-container/.claude/README.md`

Claude Code session hook that automatically executes the Beads session-ending protocol when sessions end. Warns about in-progress tasks, shows open tasks, and syncs the Beads database.

### 40. Container Directory Communication System
**Location:** `jib-container/README.md`

Shared directory structure enabling communication between container and host including notifications (agent -> human), incoming (human -> agent), responses, and context directories.

## Utilities

### 41. Documentation Search Utility
**Location:** `host-services/sync/context-sync/utils/search.py`

Provides local full-text search across all synced documentation with context and relevance ranking. Supports filtering by space, case-sensitive search, and statistics display.

### 42. Sync Maintenance Tools
**Location:** `host-services/sync/context-sync/utils/maintenance.py`

Provides sync status monitoring showing statistics across spaces and pages, and cleanup utilities to find and remove orphaned files.

### 43. Symlink Management for Projects
**Location:** `host-services/sync/context-sync/utils/create_symlink.py`, `host-services/sync/context-sync/utils/link_to_khan_projects.py`

Tools to create and manage symlinks from other projects to synced documentation, making it available in multiple Khan Academy projects.

### 44. Rate Limiting Handler
**Location:** `host-services/sync/context-sync/connectors/jira/sync.py`, `host-services/sync/context-sync/connectors/confluence/sync.py`

Automatic rate limit detection and retry logic for both JIRA and Confluence APIs with Retry-After header respect and configurable delays.

### 45. Codebase Index Query Tool
**Location:** `host-services/analysis/index-generator/query-index.py`

CLI tool for querying generated codebase indexes with subcommands for summaries, components, patterns, dependencies, structure, and search across all indexes.

### 46. Worktree Watcher Service
**Location:**
- `host-services/utilities/worktree-watcher/worktree-watcher.sh`
- `host-services/utilities/worktree-watcher/worktree-watcher.service`
- `host-services/utilities/worktree-watcher/worktree-watcher.timer`

Automatically cleans up orphaned git worktrees and temporary branches from stopped/crashed jib containers every 15 minutes. Prevents accumulation, saves disk space, and safely deletes branches only when work is captured.

### 47. Test Discovery Tool
**Location:** `jib-container/scripts/discover-tests.py`, `jib-container/jib-tools/discover-tests.py`

Dynamically discovers test configurations and frameworks in any codebase. Supports Python (pytest/unittest), JavaScript (Jest/Mocha/Vitest/Playwright), Go, and Java (Gradle/Maven). Provides recommended test commands.

## Security Features

### 48. GitHub Token Refresher Service
**Location:**
- `host-services/utilities/github-token-refresher/github-token-refresher.py`
- `host-services/utilities/github-token-refresher/github-token-refresher.service`
- `host-services/utilities/github-token-refresher/setup.sh`

Systemd daemon that automatically refreshes GitHub App installation tokens every 45 minutes before the 1-hour expiry. Writes tokens to a shared file accessible to containers for continuous GitHub authentication.

## Configuration

### 49. Master Setup System
**Location:** `setup.sh`

Comprehensive installation and configuration script for all james-in-a-box host components. Handles initial setup, updates, and force reinstalls with interactive prompts, dependency checking, service management, and configuration validation.

**Components:**

- **Dependency Management** (`setup.sh`)
  - Automated detection and installation of required dependencies including Python (uv), Go, Beads, and Docker.
- **Systemd Service Management** (`setup.sh`)
  - Manages systemd user services for all jib components including daemon reload, service restart, and status monitoring.
- **Shared Directory Structure Setup** (`setup.sh`)
  - Creates and manages the shared directory structure (~/.jib-sharing) for notifications, incoming messages, responses, and context data.
- **GitHub App Authentication Setup** (`setup.sh`)
  - Interactive wizard for configuring GitHub App authentication including App ID, Installation ID, and private key management.
- **Slack Integration Configuration** (`setup.sh`)
  - Validates and configures Slack bot tokens (SLACK_TOKEN) and app tokens (SLACK_APP_TOKEN) for bidirectional communication.
- **Docker Image Pre-Build** (`setup.sh`)
  - Pre-builds the james-in-a-box Docker image during setup so the first 'jib' command runs quickly.

### 50. Interactive Configuration Setup
**Location:** `host-services/sync/context-sync/utils/setup.py`

Interactive setup wizard for configuring connector credentials and settings with secure credential storage in environment files with proper permissions.

### 51. Claude Agent Rules System
**Location:**
- `jib-container/.claude/rules/mission.md`
- `jib-container/.claude/rules/environment.md`
- `jib-container/.claude/rules/beads-usage.md`
- `jib-container/.claude/rules/context-tracking.md`
- `jib-container/.claude/rules/khan-academy.md`
- *...and 4 more*

Core behavioral configuration defining the Claude agent's role, operating model, workflow patterns, decision frameworks, quality standards, and communication style for autonomous software engineering.

**Components:**

- **Agent Mission Rules** (`jib-container/.claude/rules/mission.md`)
  - Defines agent's role, workflow (beads -> context -> plan -> implement -> test -> PR), decision framework, and quality standards.
- **Sandbox Environment Rules** (`jib-container/.claude/rules/environment.md`)
  - Documents technical constraints of sandboxed Docker environment including security model and GitHub MCP configuration.
- **Khan Academy Development Standards** (`jib-container/.claude/rules/khan-academy.md`)
  - Tech stack, code standards for Python and JavaScript, testing requirements, and common commands.
- **PR Description Guidelines** (`jib-container/.claude/rules/pr-descriptions.md`)
  - Standardized PR description format following Khan Academy conventions with format templates and anti-patterns.
- **Test Workflow Rules** (`jib-container/.claude/rules/test-workflow.md`)
  - Comprehensive test discovery and execution workflow rules for different codebases.
- **Notification Guidelines** (`jib-container/.claude/rules/notification-template.md`)
  - Rules for async notifications to humans via Slack with priority guidelines.

---

## Maintaining This List

This feature list is maintained by the Feature Analyzer tool.

### Update Commands

```bash
# Regenerate entire list from scratch
feature-analyzer full-repo --repo-root /path/to/repo

# Weekly incremental updates
feature-analyzer weekly-analyze --days 7
```

**Last Updated:** 2025-12-02

### Communication (Auto-detected)

#### Slack Notification Library **[implemented]**
- **Description**: A unified notification library for sending messages to Slack via file-based communication with the host-side notifier. Supports threading, multiple notification types, and GitHub-specific helpers for PR notifications.
- **Implementation**:
  - `shared/notifications/__init__.py`
  - `shared/notifications/base.py`
  - `shared/notifications/types.py`
  - `shared/notifications/slack.py`


### Configuration (Auto-detected)

#### Host Configuration Management **[implemented]**
- **Description**: Unified configuration system for jib host services that consolidates all host-side settings under ~/.config/jib/. Provides loading of non-secret config from YAML, secrets from .env files, and GitHub tokens from dedicated files. Includes migration utilities for legacy config locations and CLI for inspection/management.
- **Implementation**:
  - `config/host_config.py`
  - `config/README.md`

#### Repository Access Configuration **[implemented]**
- **Description**: Single source of truth for GitHub repository access permissions. Controls which repos jib can write to (push changes, create PRs) vs read-only repos (monitoring only). Provides programmatic API and CLI for querying repo access levels and selecting appropriate GitHub tokens.
- **Implementation**:
  - `config/repo_config.py`
  - `config/README.md`

#### Model Pricing Configuration **[implemented]**
- **Description**: Provides current pricing information for LLM models used by jib, including Claude Opus, Sonnet, and Haiku variants. Used by inefficiency detector for cost estimates and usage analytics.
- **Implementation**:
  - `config/model_pricing.py`


### Container Infrastructure (Auto-detected)

#### Service Failure Notification System **[implemented]**
- **Description**: A systemd template service that provides automatic failure notifications when other systemd services fail. Integrates with systemd's OnFailure directive for proactive alerting.
- **Implementation**:
  - `host-services/utilities/service-failure-notify/setup.sh`
  - `host-services/utilities/service-failure-notify/service-failure-notify@.service`

#### Bin Symlink Validator **[implemented]**
- **Description**: Lint check that ensures all container executables have corresponding symlinks in jib-container/bin/ to prevent 'executable not found in $PATH' errors.
- **Implementation**:
  - `scripts/check-bin-symlinks.py`


### Context Management (Auto-detected)

#### PR Context Manager **[implemented]**
- **Description**: A library for managing persistent GitHub PR context in the Beads task tracking system. Enables tracking PR work across container sessions including comments, CI check failures, review feedback, and merge conflicts.
- **Implementation**:
  - `shared/beads/__init__.py`
  - `shared/beads/pr_context.py`


### Core Architecture (Auto-detected)

#### Claude Agent Rules System **[implemented]**
- **Description**: A comprehensive instruction system for Claude Code agents operating in sandboxed Docker environments. Provides mission definition, operating model, workflow guidance, decision frameworks, and quality standards for autonomous software engineering tasks.
- **Implementation**:
  - `.claude/rules/README.md`
  - `.claude/rules/mission.md`
  - `.claude/rules/beads-usage.md`
  - `.claude/rules/context-tracking.md`
  - `.claude/rules/environment.md`

#### Claude CLI Runner **[implemented]**
- **Description**: A Python library providing a unified interface for running Claude CLI in non-interactive mode with streaming output support. Enables programmatic invocation with full tool and filesystem access, real-time streaming, and comprehensive error handling.
- **Implementation**:
  - `shared/claude/__init__.py`
  - `shared/claude/runner.py`

#### JibLogger Structured Logging System **[implemented]**
- **Description**: Unified structured logging interface for jib components with JSON output, context propagation, and GCP Cloud Logging compatibility. Provides environment-aware formatting and file rotation support.
- **Implementation**:
  - `shared/jib_logging/__init__.py`
  - `shared/jib_logging/logger.py`
  - `shared/jib_logging/formatters.py`
  - `shared/jib_logging/context.py`
  - `shared/jib_logging/cli.py`


### Custom Commands (Auto-detected)

#### Claude Custom Commands **[implemented]**
- **Description**: A comprehensive set of slash commands available in the sandboxed environment for context management, PR creation, task tracking, and documentation updates.
- **Implementation**:
  - `.claude/commands/README.md`


### Documentation System (Auto-detected)

#### Confluence Documentation Discoverer **[implemented]**
- **Description**: CLI tool that scans pre-synced Confluence documentation to find organization-specific documents relevant to a target repository. Analyzes document content, detects categories, calculates relevance confidence scores, and outputs JSON for integration into repository documentation indexes.
- **Implementation**:
  - `host-services/analysis/confluence-doc-discoverer/confluence-doc-discoverer.py`
  - `host-services/analysis/confluence-doc-discoverer/setup.sh`

#### Repository Onboarding Orchestrator **[implemented]**
- **Description**: Full repository onboarding orchestration that runs all phases of preparing a repository for Jib: Confluence discovery, feature analysis, index generation, and documentation index updates. Supports dry-run mode and public repo handling.
- **Implementation**:
  - `host-services/analysis/repo-onboarding/jib-internal-devtools-setup`
  - `host-services/analysis/repo-onboarding/README.md`
  - `host-services/analysis/repo-onboarding/jib-regenerate-indexes`
  - `host-services/analysis/repo-onboarding/docs-index-updater.py`
  - `host-services/analysis/repo-onboarding/setup.sh`


### Security Features (Auto-detected)

#### Claude/Anthropic Import Linter **[implemented]**
- **Description**: Security lint check that ensures host-services code never imports Claude or Anthropic modules directly, enforcing the security boundary where LLM calls must go through the container.
- **Implementation**:
  - `scripts/check-claude-imports.py`

#### Container Path Pattern Linter **[implemented]**
- **Description**: Detects problematic sys.path patterns that use dynamic repository names instead of explicit paths, preventing ModuleNotFoundError in container environments.
- **Implementation**:
  - `scripts/check-container-paths.py`

#### GitHub CLI Write Operation Linter **[implemented]**
- **Description**: Security lint check that prevents gh CLI write operations from running directly in host-services, ensuring GitHub write operations go through the jib container.
- **Implementation**:
  - `scripts/check-gh-cli-usage.py`


### Utilities (Auto-detected)

#### Git Repository Utilities **[implemented]**
- **Description**: Provides utility functions for working with git repositories from host-side services, including extracting owner/repo strings from git remote URLs (both HTTPS and SSH formats).
- **Implementation**:
  - `host-services/shared/git_utils.py`

#### Tool Wrapper Framework **[implemented]**
- **Description**: A comprehensive library providing wrapped versions of critical command-line tools (bd, git, gh, claude) that automatically log invocations, capture output, and record timing information with structured logging integration.
- **Implementation**:
  - `shared/jib_logging/wrappers/__init__.py`
  - `shared/jib_logging/wrappers/base.py`
  - `shared/jib_logging/bin/README.md`
  - `shared/jib_logging/bin/setup-aliases.sh`

#### Text Utilities **[implemented]**
- **Description**: Shared text processing utilities for message chunking and YAML frontmatter parsing used across jib components.
- **Implementation**:
  - `shared/text_utils/__init__.py`
  - `shared/text_utils/chunking.py`
  - `shared/text_utils/frontmatter.py`

#### Bin Symlink Management **[implemented]**
- **Description**: Maintains convenient symlinks to commonly used commands across the jib ecosystem. The maintain-bin-symlinks tool automatically creates and updates symlinks to executables in host-services/ and jib-container/ directories.
- **Implementation**:
  - `bin/README.md`

