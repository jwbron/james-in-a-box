# Generated Documentation

This directory contains machine-readable documentation indexes generated by automated analysis tools.

## Files

| File | Description | Generator |
|------|-------------|-----------|
| `codebase.json` | Structured codebase analysis (components, files, relationships) | index-generator.py |
| `patterns.json` | Extracted code patterns and conventions | index-generator.py |
| `dependencies.json` | Internal and external dependency graph | index-generator.py |

## Purpose

These files enable LLMs to efficiently query specific information without loading entire documentation.

## Query Tool

Use the `query-index.py` CLI tool instead of raw jq:

```bash
# View codebase summary
bin/query-index summary

# Find component by name
bin/query-index component GitHubWatcher

# List all detected patterns
bin/query-index pattern

# Show specific pattern details
bin/query-index pattern connector

# Show project structure
bin/query-index structure

# Search across all indexes
bin/query-index search notification

# Show external dependencies
bin/query-index deps
```

Or use jq directly:

```bash
# Get info about a specific component
jq '.components[] | select(.name == "GitHubWatcher")' codebase.json

# Find files using a pattern
jq '.patterns.connector.examples' patterns.json

# Get external dependencies
jq '.external' dependencies.json
```

## Generation

Regenerate indexes manually:

```bash
bin/generate-index
# Or directly:
python3 host-services/analysis/index-generator/index-generator.py
```

Enable weekly auto-regeneration:

```bash
cd host-services/analysis/index-generator
./setup.sh enable
```

## Documentation Authoring (Phases 4 & 5)

The doc-generator uses a **6-agent pipeline** for documentation generation:

1. **Context Agent** - Analyzes code patterns and gathers context
2. **Draft Agent** - Generates initial documentation
3. **Review Agent** - Validates accuracy and completeness
4. **External Validation Agent** - Researches industry best practices
5. **Revise Agent** - Incorporates external feedback
6. **Output Agent** - Formats and saves documentation

### Generate Documentation

```bash
# List available topics
bin/generate-docs --list-topics

# Generate status quo docs (descriptive, no external validation)
bin/generate-docs --topic notification --type status-quo

# Generate best practice docs (includes external validation)
bin/generate-docs --topic security --type best-practice

# Skip external validation (faster, works offline)
bin/generate-docs --topic auth --type best-practice --skip-external

# Generate all pattern documentation
bin/generate-docs --all

# Preview without saving
bin/generate-docs --all --dry-run
```

### Research Best Practices

```bash
# Research a topic (standalone, updates cache)
bin/generate-docs --research security

# Research outputs:
# - Best practices from authoritative sources
# - Anti-patterns to avoid
# - Source references
# - Research prompt for manual/LLM research
```

### Check Documentation Drift

```bash
# Check all docs for stale references
bin/check-doc-drift

# Include fix suggestions
bin/check-doc-drift --suggest-fixes

# JSON output for automation
bin/check-doc-drift --json
```

### Enable Scheduled Generation

```bash
# Enable all timers (research + docs)
bin/setup-doc-generator enable

# Enable only research timer
bin/setup-doc-generator enable-research

# Run full pipeline immediately
bin/setup-doc-generator run

# Check status
bin/setup-doc-generator status
```

## Generation Schedule

| Index | Frequency | Trigger |
|-------|-----------|---------|
| All indexes | Weekly (Sunday 3am) | Systemd timer (if enabled) |
| All indexes | On-demand | `bin/generate-index` |

## Schema

See [ADR: LLM Documentation Index Strategy](../adr/ADR-LLM-Documentation-Index-Strategy.md) for detailed schema definitions.

## Status

**Phase 1 (Complete):** Directory structure, navigation index, llms.txt
**Phase 2 (Complete):** Codebase analyzer with pattern extraction and dependency analysis
**Phase 3 (Complete):** Spec enrichment workflow
**Phase 4 (Complete):** LLM documentation authoring and drift detection
**Phase 5 (Complete):** External best practices integration with 6-agent pipeline

---

*Do not manually edit files in this directory. They are auto-generated.*
